branches:
  - main

plugins:
  # Analyser les commits conventionnels et d√©terminer la version
  - - "@semantic-release/commit-analyzer"
    - preset: "conventionalcommits"
      releaseRules:
        - type: "feat"
          release: "minor"
        - type: "fix"
          release: "patch"
        - type: "perf"
          release: "patch"
        - type: "refactor"
          release: "patch"
        - type: "docs"
          release: false
        - type: "test"
          release: false
        - type: "chore"
          release: false
        - type: "ci"
          release: false
        - type: "build"
          release: "patch"
        - scope: "breaking"
          release: "major"

  # G√©n√©rer les release notes
  - - "@semantic-release/release-notes-generator"
    - preset: "conventionalcommits"
      presetConfig:
        types:
          - type: "feat"
            section: "üöÄ Features"
          - type: "fix"
            section: "üêõ Bug Fixes"
          - type: "perf"
            section: "‚ö° Performance"
          - type: "refactor"
            section: "‚ôªÔ∏è Refactoring"
          - type: "build"
            section: "üîß Build"
          - type: "docs"
            section: "üìö Documentation"
          - type: "test"
            section: "‚úÖ Tests"
          - type: "chore"
            section: "üßπ Chores"
          - type: "ci"
            section: "üë∑ CI/CD"

  # G√©n√©rer/mettre √† jour CHANGELOG.md
  - - "@semantic-release/changelog"
    - changelogFile: "CHANGELOG.md"
      changelogTitle: "# Changelog\n\nToutes les modifications notables de ce projet seront document√©es dans ce fichier.\n\nLe format est bas√© sur [Keep a Changelog](https://keepachangelog.com/fr/1.0.0/),\net ce projet adh√®re au [Semantic Versioning](https://semver.org/lang/fr/)."

  # Mettre √† jour les fichiers avec la nouvelle version
  - - "@semantic-release/exec"
    - prepareCmd: |
        # Mettre √† jour la version dans go.mod si n√©cessaire
        # Mettre √† jour la version dans Makefile
        sed -i "s/VERSION := .*/VERSION := ${nextRelease.version}/" Makefile

  # Commiter les changements (CHANGELOG.md, etc.)
  - - "@semantic-release/git"
    - assets:
        - "CHANGELOG.md"
        - "Makefile"
      message: "chore(release): ${nextRelease.version} [skip ci]\n\n${nextRelease.notes}"

  # Cr√©er la release GitHub avec les notes
  - - "@semantic-release/github"
    - successComment: false
      failComment: false
      releasedLabels: false
      assets: []

# Options globales
tagFormat: "v${version}"
